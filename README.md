# Speech Style Classifier

<div align="center">

[![Python](https://img.shields.io/badge/Python-3.8%2B-blue?logo=python)](https://www.python.org/)
[![Telegram](https://img.shields.io/badge/Telegram-Bot-blue?logo=telegram)](https://telegram.org/)
[![ML](https://img.shields.io/badge/Machine-Learning-orange)](https://scikit-learn.org/)
[![NLP](https://img.shields.io/badge/NLP-Transformers-yellow)](https://huggingface.co/)
[![FFmpeg](https://img.shields.io/badge/FFmpeg-Audio%20Processing-green)](https://ffmpeg.org/)

**AI-powered system for classifying speech style from voice messages**

</div>

## Ðž Ð¿Ñ€Ð¾ÐµÐºÑ‚Ðµ

Ð¡Ð¸ÑÑ‚ÐµÐ¼Ð° Ð´Ð»Ñ Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¾Ð³Ð¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ ÑÑ‚Ð¸Ð»Ñ Ñ€ÐµÑ‡Ð¸ (Ñ€Ð°Ð·Ð³Ð¾Ð²Ð¾Ñ€Ð½Ñ‹Ð¹ vs Ð¾Ñ„Ð¸Ñ†Ð¸Ð°Ð»ÑŒÐ½Ð¾-Ð´ÐµÐ»Ð¾Ð²Ð¾Ð¹) Ð¸Ð· Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ñ‹Ñ… ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ð¹. ÐŸÑ€Ð¾ÐµÐºÑ‚ Ð¾Ð±ÑŠÐµÐ´Ð¸Ð½ÑÐµÑ‚ ÑÐ¾Ð²Ñ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ñ‹ Ð¼Ð°ÑˆÐ¸Ð½Ð½Ð¾Ð³Ð¾ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ Ñ ÑƒÐ´Ð¾Ð±Ð½Ñ‹Ð¼ Telegram-Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹ÑÐ¾Ð¼.

### ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ÑÑ‚Ð¸

- **ðŸŽ™ï¸ Ð Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð²Ð°Ð½Ð¸Ðµ Ñ€ÐµÑ‡Ð¸** â€” Ð¿ÐµÑ€Ð²Ð¸Ñ‡Ð½Ð¾ Salute Speech (HTTP/2 API), Ð°Ð²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸ Ð¿ÐµÑ€ÐµÐºÐ»ÑŽÑ‡Ð°ÐµÑ‚ÑÑ Ð½Ð° Google Speech Ð² ÐºÐ°Ñ‡ÐµÑÑ‚Ð²Ðµ Ñ€ÐµÐ·ÐµÑ€Ð²Ð½Ð¾Ð³Ð¾ Ð²Ð°Ñ€Ð¸Ð°Ð½Ñ‚Ð°
- **ðŸ¤– ÐšÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ñ Ñ‚ÐµÐºÑÑ‚Ð°** - multiple ML Ð¿Ð¾Ð´Ñ…Ð¾Ð´Ñ‹ Ð´Ð»Ñ Ñ‚Ð¾Ñ‡Ð½Ð¾Ð³Ð¾ Ð¾Ð¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ ÑÑ‚Ð¸Ð»Ñ Ñ€ÐµÑ‡Ð¸
- **ðŸ§  ÐÐ°Ð±Ð¾Ñ€ Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹** â€” logistic regression, TextCNN, BERT, fastText Ð¸ Ð°Ð½ÑÐ°Ð¼Ð±Ð»ÑŒ; Ñ€ÐµÐ¶Ð¸Ð¼ Â«Ð’ÑÐµÂ» Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ð²ÑÐµ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð¸ ÑÐ¾Ð±Ð¸Ñ€Ð°ÐµÑ‚ ÑÐ²Ð¾Ð´ÐºÑƒ
- **ðŸ“± Telegram Ð±Ð¾Ñ‚** - ÑƒÐ´Ð¾Ð±Ð½Ñ‹Ð¹ Ð¸Ð½Ñ‚ÐµÑ€Ñ„ÐµÐ¹Ñ Ð´Ð»Ñ Ð²Ð·Ð°Ð¸Ð¼Ð¾Ð´ÐµÐ¹ÑÑ‚Ð²Ð¸Ñ
- **âš¡ REST API** - Ð³Ð¾Ñ‚Ð¾Ð²Ñ‹Ð¹ Ð±ÑÐºÐµÐ½Ð´ Ð´Ð»Ñ Ð¸Ð½Ñ‚ÐµÐ³Ñ€Ð°Ñ†Ð¸Ð¸
- **ðŸ”Š ÐŸÐ¾Ð´Ð´ÐµÑ€Ð¶ÐºÐ° Ð°ÑƒÐ´Ð¸Ð¾Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð¾Ð²** - Ñ€Ð°Ð±Ð¾Ñ‚Ð° Ñ Ñ€Ð°Ð·Ð»Ð¸Ñ‡Ð½Ñ‹Ð¼Ð¸ Ð°ÑƒÐ´Ð¸Ð¾Ñ„Ð¾Ñ€Ð¼Ð°Ñ‚Ð°Ð¼Ð¸ Ñ‡ÐµÑ€ÐµÐ· FFmpeg

## âš™ï¸ ÐšÐ¾Ð½Ñ„Ð¸Ð³ÑƒÑ€Ð°Ñ†Ð¸Ñ

ÐžÑÐ½Ð¾Ð²Ð½Ñ‹Ðµ Ð¿ÐµÑ€ÐµÐ¼ÐµÐ½Ð½Ñ‹Ðµ Ð¾ÐºÑ€ÑƒÐ¶ÐµÐ½Ð¸Ñ Ð¿ÐµÑ€ÐµÑ‡Ð¸ÑÐ»ÐµÐ½Ñ‹ Ð² `env.example`:

- `SALUTE_AUTH_KEY` â€” Ð¾Ð±ÑÐ·Ð°Ñ‚ÐµÐ»ÑŒÐ½Ñ‹Ð¹ Base64(ClientID:ClientSecret) Ð´Ð»Ñ Salute Speech.
- `SALUTE_SCOPE` â€” Ð¾Ð±Ð»Ð°ÑÑ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð° (Ð¿Ð¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ `SALUTE_SPEECH_PERS`).
- `FFMPEG_BIN`, `FFPROBE_BIN` â€” Ð¿ÑƒÑ‚Ð¸ Ðº ÑƒÑ‚Ð¸Ð»Ð¸Ñ‚Ð°Ð¼ FFmpeg/FFprobe, ÐµÑÐ»Ð¸ Ð¾Ð½Ð¸ Ð½Ðµ Ð»ÐµÐ¶Ð°Ñ‚ Ð² `PATH`.
- `MIN_WORDS`, `MIN_DURATION` â€” Ð¾Ð³Ñ€Ð°Ð½Ð¸Ñ‡ÐµÐ½Ð¸Ñ Ð½Ð° Ð´Ð»Ð¸Ð½Ñƒ Ñ€Ð°ÑÐ¿Ð¾Ð·Ð½Ð°Ð½Ð½Ð¾Ð³Ð¾ Ñ‚ÐµÐºÑÑ‚Ð° Ð¸ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð¾Ð³Ð¾ ÑÐ¾Ð¾Ð±Ñ‰ÐµÐ½Ð¸Ñ.
- `SERVER_URL` â€” Ð±Ð°Ð·Ð¾Ð²Ñ‹Ð¹ URL FastAPI-ÑÐµÑ€Ð²ÐµÑ€Ð° Ð´Ð»Ñ Telegram-Ð±Ð¾Ñ‚Ð°.

Ð”Ð»Ñ ÐºÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ†Ð¸Ð¸ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹ Ð¼Ð¾Ð´ÐµÐ»Ð¸ `logistic`, `cnn`, `bert`, `fasttext`, `ensemble` Ð¸ ÑÐ¿ÐµÑ†Ð¸Ð°Ð»ÑŒÐ½Ñ‹Ð¹ Ñ€ÐµÐ¶Ð¸Ð¼ `all`, Ð² ÐºÐ¾Ñ‚Ð¾Ñ€Ð¾Ð¼ Ñ„Ð¸Ð½Ð°Ð»ÑŒÐ½Ð°Ñ Ð¼ÐµÑ‚ÐºÐ° Ð²Ñ‹Ð±Ð¸Ñ€Ð°ÐµÑ‚ÑÑ Ð¿Ð¾ Ð±Ð¾Ð»ÑŒÑˆÐ¸Ð½ÑÑ‚Ð²Ñƒ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð² (Ð¿Ñ€Ð¸ Ñ€Ð°Ð²ÐµÐ½ÑÑ‚Ð²Ðµ â€” Ð¿Ð¾ ÑÑ€ÐµÐ´Ð½ÐµÐ¹ Ð¸ Ð¼Ð°ÐºÑÐ¸Ð¼Ð°Ð»ÑŒÐ½Ð¾Ð¹ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸), Ð° Ð¾Ñ‚Ð²ÐµÑ‚ ÑÐ¾Ð´ÐµÑ€Ð¶Ð¸Ñ‚ ÑÐ²Ð¾Ð´ÐºÑƒ Ð¸ Ð¿ÐµÑ€ÐµÑ‡ÐµÐ½ÑŒ Ð¸Ð½Ð´Ð¸Ð²Ð¸Ð´ÑƒÐ°Ð»ÑŒÐ½Ñ‹Ñ… Ð¿Ñ€Ð¾Ð³Ð½Ð¾Ð·Ð¾Ð².

### Ð¡Ñ‚Ñ€ÑƒÐºÑ‚ÑƒÑ€Ð° Ð°Ñ€Ñ‚ÐµÑ„Ð°ÐºÑ‚Ð¾Ð² Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹

```
server/models/
â”œâ”€â”€ lr/                 # Ð›Ð¾Ð³Ð¸ÑÑ‚Ð¸Ñ‡ÐµÑÐºÐ°Ñ Ñ€ÐµÐ³Ñ€ÐµÑÑÐ¸Ñ
â”‚   â”œâ”€â”€ lr_model.pkl
â”‚   â””â”€â”€ tfidf_vectorizer.pkl
â”œâ”€â”€ cnn/                # TextCNN
â”‚   â”œâ”€â”€ cnn_best.pth
â”‚   â””â”€â”€ vocab.pkl
â”œâ”€â”€ bert/               # ÐšÐ»Ð°ÑÑÐ¸Ñ„Ð¸ÐºÐ°Ñ‚Ð¾Ñ€ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ RuBERT
â”‚   â””â”€â”€ bert_classifier_best.pth
â”œâ”€â”€ fasttext/           # fastText baseline
â”‚   â”œâ”€â”€ fasttext_ensemble.bin
â”‚   â””â”€â”€ label_index.json
â””â”€â”€ ensemble/           # ÐÐ½ÑÐ°Ð¼Ð±Ð»ÑŒ Ð»Ð¾Ð³Ñ€ÐµÐ³ + TextCNN
    â”œâ”€â”€ feature_union.joblib
    â”œâ”€â”€ logreg_elasticnet.joblib
    â”œâ”€â”€ textcnn_state.pt
    â”œâ”€â”€ sequence_vocab.json
    â””â”€â”€ label_index.json
```

ÐšÑ€ÑƒÐ¿Ð½Ñ‹Ðµ Ð±Ð¸Ð½Ð°Ñ€Ð½Ð¸ÐºÐ¸ Ð¸ÑÐºÐ»ÑŽÑ‡ÐµÐ½Ñ‹ Ð¸Ð· git (`.gitignore`), Ð¿Ð¾ÑÑ‚Ð¾Ð¼Ñƒ Ð¿Ð¾ÑÐ»Ðµ ÐºÐ»Ð¾Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ñ Ñ€ÐµÐ¿Ð¾Ð·Ð¸Ñ‚Ð¾Ñ€Ð¸Ñ Ð½ÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ Ð¿Ð¾Ð¼ÐµÑÑ‚Ð¸Ñ‚ÑŒ Ð¸Ñ… Ð²Ñ€ÑƒÑ‡Ð½ÑƒÑŽ.

### Ð›Ð¾ÐºÐ°Ð»ÑŒÐ½Ð°Ñ Ð¿Ñ€Ð¾Ð²ÐµÑ€ÐºÐ° Ð±ÐµÐ· Ð±ÑÐºÐµÐ½Ð´Ð°

Ð”Ð»Ñ Ð±Ñ‹ÑÑ‚Ñ€Ð¾Ð³Ð¾ Ñ‚ÐµÑÑ‚Ð° Ð¼Ð¾Ð´ÐµÐ»ÐµÐ¹ Ð±ÐµÐ· Ð·Ð°Ð¿ÑƒÑÐºÐ° ÑÐµÑ€Ð²ÐµÑ€Ð° Ð¸ Ð±Ð¾Ñ‚Ð° Ð¸ÑÐ¿Ð¾Ð»ÑŒÐ·ÑƒÐ¹Ñ‚Ðµ CLI:

```bash
python tools/classify_text.py "Ð”Ð¾Ð±Ñ€Ñ‹Ð¹ Ð´ÐµÐ½ÑŒ, ÐºÐ¾Ð»Ð»ÐµÐ³Ð¸. ÐŸÑ€Ð¾ÑˆÑƒ ÑÐ¾Ð³Ð»Ð°ÑÐ¾Ð²Ð°Ñ‚ÑŒ Ð´Ð¾ÐºÑƒÐ¼ÐµÐ½Ñ‚."
python tools/classify_text.py "ÐŸÑ€Ð¸Ð²ÐµÑ‚! ÐšÐ°Ðº Ð´ÐµÐ»Ð°?" -m logistic cnn
python tools/classify_text.py --list  # Ð¿Ð¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð´Ð¾ÑÑ‚ÑƒÐ¿Ð½Ñ‹Ðµ Ð¼Ð¾Ð´ÐµÐ»Ð¸
```

ÐŸÐ¾ ÑƒÐ¼Ð¾Ð»Ñ‡Ð°Ð½Ð¸ÑŽ ÑÐºÑ€Ð¸Ð¿Ñ‚ Ð·Ð°Ð¿ÑƒÑÐºÐ°ÐµÑ‚ Ñ€ÐµÐ¶Ð¸Ð¼ `all` Ð¸ Ð²Ñ‹Ð²Ð¾Ð´Ð¸Ñ‚ ÑÐ²Ð¾Ð´ÐºÑƒ Ð¿Ð¾ Ð²ÑÐµÐ¼ Ð¼Ð¾Ð´ÐµÐ»ÑÐ¼ Ð²Ð¼ÐµÑÑ‚Ðµ Ñ Ð³Ð¾Ð»Ð¾ÑÐ¾Ð²Ð°Ð½Ð¸ÐµÐ¼.

## ðŸ—ï¸ ÐÑ€Ñ…Ð¸Ñ‚ÐµÐºÑ‚ÑƒÑ€Ð°

```mermaid
graph LR
    A[ÐŸÐ¾Ð»ÑŒÐ·Ð¾Ð²Ð°Ñ‚ÐµÐ»ÑŒ] --> B[Telegram Bot]
    B --> C[FastAPI Server]
    C --> D[Audio Processor]
    D --> E[FFmpeg/FFprobe]
    E --> F[Speech Recognition]
    F --> G[Text Classifier]
    G --> H[Response]
    H --> B --> A
